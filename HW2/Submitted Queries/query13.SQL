select h.ssn, h.name, k.company, k.tripnbr, h.date from (select reservation.ssn, passenger.name, reservation.code, reservation.date, d.count from reservation, passenger, (select r.ssn, count(r.ssn) count from reservation r group by r.date) d where reservation.ssn = d.ssn and reservation.ssn = passenger.ssn) h inner join (select f.code, f.company, f.tripnbr, k.count from tripinfo f, (select t.tripnbr, count(t.tripnbr) count from tripinfo t group by t.tripnbr) k where f.tripnbr = k.tripnbr) k on h.code = k.code and h.count = k.count;